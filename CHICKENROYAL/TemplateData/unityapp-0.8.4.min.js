(()=>{"use strict";function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(n,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,(void 0,a=function(n,t){if("object"!==e(n)||null===n)return n;var o=n[Symbol.toPrimitive];if(void 0!==o){var i=o.call(n,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(i.key),"symbol"===e(a)?a:String(a)),i)}var a}var t=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={}}var t,o;return t=e,o=[{key:"emit",value:function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];(this.events[e]||[]).forEach((function(e){return e.apply(void 0,t)}))}},{key:"on",value:function(e,n){var t=this;return(this.events[e]=this.events[e]||[]).push(n),function(){t.events[e]=(t.events[e]||[]).filter((function(e){return e!==n}))}}},{key:"once",value:function(e,n){var t=this.on(e,(function(){n.apply(void 0,arguments),t()}));return t}},{key:"clear",value:function(){this.events={}}}],o&&n(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,a=function(e,n){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===o(a)?a:String(a)),i)}var a}var a=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.autoSave,i=void 0===o||o,a=t.backend,r=void 0===a?null:a,c=t.autoSavePeriod,s=void 0===c?3e3:c;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._isAutoSave=!!i,this._data={},this._backend=r,this._isModified=!1,this._isAutoSave&&(this._saver=setInterval((function(){n.save()}),s))}var n,t;return n=e,t=[{key:"setItem",value:function(e,n){e in this._data&&this._data[e]===n||(this._data.__modified_at__=(new Date).getTime(),this._data[e]=n,this._isModified=!0)}},{key:"setFloat",value:function(e,n){this.setItem(e,n)}},{key:"getFloat",value:function(e,n){try{var t=this._data[e];if("string"==typeof t)return Number.parseFloat(t);if("number"==typeof t)return t}catch(e){console.error(e)}return n}},{key:"setInt",value:function(e,n){this.setItem(e,n)}},{key:"getInt",value:function(e,n){try{var t=this._data[e];if("string"==typeof t)return Number.parseInt(t,10);if("number"==typeof t)return Math.trunc(t)}catch(e){console.error(e)}return n}},{key:"setString",value:function(e,n){this.setItem(e,n.toString())}},{key:"getString",value:function(e,n){var t=this._data[e];return"string"==typeof t?t:n}},{key:"hasKey",value:function(e){return e in this._data}},{key:"deleteKey",value:function(e){this.hasKey(e)&&(delete this._data[e],this._isModified=!0,this._data.__modified_at__=(new Date).getTime())}},{key:"deleteAll",value:function(){this._data={__modified_at__:(new Date).getTime()},this._isModified=!0}},{key:"save",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this._isModified||e)&&(this._backend.save(this._data),this._isModified=!1)}},{key:"load",value:function(){var e=this;return this._backend.load().then((function(n){e._data=n||{}}))}}],t&&i(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function c(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==r(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var s=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.path,i=void 0===o?"index.html":o,a=t.interval,r=void 0===a?5e3:a,c=t.timeout,s=void 0===c?4500:c;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._path=i||"index.html",this._randomParamName="rnd",this._isConnection=!0,this._testTime=0,this._interval=setInterval((function(){return n._testConnection({timeout:s})}),r)}var n,t;return n=e,t=[{key:"hasConnection",value:function(){return this._isConnection}},{key:"_testConnection",value:function(){var e=this,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).timeout,t=void 0===n?5e3:n,o=(new Date).getTime(),i=o.toString(),a="".concat(this._path,"?").concat(this._randomParamName,"=").concat(i),r=new AbortController,c=setTimeout((function(){return r.abort()}),t),s=function(n){clearTimeout(c),e._testTime<o&&(e._isConnection=n,e._testTime=o)};fetch(a,{signal:r.signal}).then((function(){return s(!0)})).catch((function(){return s(!1)}))}}],t&&c(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function w(e,n,t){return(n=y(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,y(o.key),o)}}function y(e){var n=function(e,n){if("object"!==u(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!==u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(n)?n:String(n)}var h=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._wasAdvShown=!1,this._isShowingAd=!1,this._ysdk=null,this._emitter=new t,this._storage=null,this._internet=new s({path:"TemplateData/internet.json"}),this._appConfig={restartMode:"scene"},this._initUnityConfig={companyName:"",productName:"",productVersion:"",buildUrl:"Build",filenameLoader:"",filenameData:"",filenameFramework:"",filenameCode:"",filenameMemory:"",filenameSymbols:"",raw:{}},this._unityConfig=null,this._unityIntance=null}var n,o;return n=e,o=[{key:"initUnityConfig",get:function(){return l({},this._initUnityConfig)}},{key:"isShowingFullscreenAdv",get:function(){return!!this._isShowingAd}},{key:"storage",get:function(){return this._storage}},{key:"isMobile",get:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},{key:"hasInternetConnection",value:function(){return this._internet.hasConnection()}},{key:"init",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.yandex,o=void 0===t?{}:t,i=n.storage,r=void 0===i?{}:i,c=n.app,s=void 0===c?{restartMode:"scene"}:c,u=n.unity,d=void 0===u?{}:u;this._addSupportPauseAndResumeEvents(),this._appConfig.restartMode=s.restartMode||this._appConfig.restartMode,this._initUnityConfig=l({companyName:"",productName:"",productVersion:"",buildUrl:"Build",filenameLoader:"",filenameData:"",filenameFramework:"",filenameCode:"",filenameMemory:"",filenameSymbols:"",raw:{}},d||{});var w=r&&r.localStorageKey?r.localStorageKey:"unityapp.storage",f={save:function(e){window.localStorage.setItem(w,JSON.stringify(e||{}))},load:function(){return new Promise((function(e){return e(JSON.parse(window.localStorage.getItem(w)||"{}"))}))}},y=r&&"remoteKey"in r?r.remoteKey:"__at_modified__",h=function(n){e._emitter.emit("AppStorageLoaded",n),e._emitter.on("AppHidden",(function(){console.log("Storage: auto save profile because lost visibility of app"),e._storage&&e._storage.save()}))};this.initYandexSDK(o).then((function(e){return e.getStorage().then((function(e){Object.defineProperty(window,"localStorage",{get:function(){return e}})})),e.getPlayer()})).then((function(){e._storage=new a({autoSave:!r||!("autoSave"in r)||!!r.autoSave,autoSavePeriod:r&&"autoSavePeriod"in r?r.autoSavePeriod:3e3,backend:{save:function(n){window.localStorage.setItem(w,JSON.stringify(n||{})),e._ysdk.getPlayer().then((function(e){return new Promise((function(n,t){e.getData([y]).then((function(t){return n({data:t,player:e})})).catch((function(e){return t(e)}))}))})).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.data,i=t.player,a=(n||{})[y],r=void 0===a?null:a,c=(o||{})[y],s=void 0===c?null:c;Number.isInteger(r)&&Number.isInteger(s)&&s>r?(console.error("Detected conflict user profile"),e.restart({mode:e._appConfig.restartMode})):i.setData(l({},n||{}))}))},load:function(){var n={};try{n=JSON.parse(window.localStorage.getItem(w)||"{}")}catch(e){console.error(e)}return e._ysdk.getPlayer().then((function(e){return e.getData()})).then((function(e){var t=(e||{})[y],o=void 0===t?0:t,i=(n||{})[y];return(void 0===i?0:i)>=o?n||{}:e||{}})).catch((function(){return n||{}}))}}}),e._storage.load().then((function(e){return h(e)}))})).catch((function(n){e._storage=new a({autoSave:!r||!("autoSave"in r)||!!r.autoSave,autoSavePeriod:r&&"autoSavePeriod"in r?r.autoSavePeriod:3e3,backend:f}),e._storage.load().then((function(e){return h(e)}))}))}},{key:"restart",value:function(){var e=this,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mode,t=void 0===n?"scene":n;this._unityInstance&&this.storage.load().then((function(){"instance"===t?e.recreateUnityInstance():e._unityInstance.SendMessage("Restarter","scene"===t?"RestartScene":"RestartGame")}))}},{key:"getYandexGames",value:function(){var e=this;return new Promise((function(n,t){null===e._ysdk||void 0===e._ysdk?e._emitter.once("YandexGamesSDK",(function(e,o){try{null===o&&null!=e?n(e):t(o)}catch(e){console.error(e)}})):n(e._ysdk)}))}},{key:"initYandexSDK",value:function(e){var n=this;if(this._ysdk)return this.getYandexGames();this._ysdk=null;var t=document.getElementsByTagName("script")[0],o=document.createElement("script");return o.src="https://yandex.ru/games/sdk/v2",o.async=!0,t.parentNode.insertBefore(o,t),o.onload=function(){!window||null!==window.YaGames&&void 0!==window.YaGames?window.YaGames.init().then((function(e){n._ysdk=e,n._emitter.emit("YandexGamesSDK",e,null)})).catch((function(e){n._emitter.emit("YandexGamesSDK",null,e)})):n._emitter.emit("YandexGamesSDK",null,new Error("Yandex SDK not found"))},this.getYandexGames()}},{key:"showFullscreenAdv",value:function(){this.getYandexGames().then((function(e){return e.adv.showFullscreenAdv({callbacks:{onOpen:function(){this._wasAdvShown=!0,this._isShowingAd=!0},onClose:function(e){this._wasAdvShown=e,this._isShowingAd=!1},onError:function(e){this._wasAdvShown=!1,this._isShowingAd=!1}}})}))}},{key:"showRewardedAds",value:function(e){this.getYandexGames().then((function(e){return e.adv.showRewardedVideo({callbacks:{onOpen:function(){console.log("Video ad open.")},onRewarded:function(){console.log("Rewarded!")},onClose:function(){console.log("Video ad closed.")},onError:function(e){console.log("Error while open video ad:",e)}}})}))}},{key:"initiatePurchase",value:function(e,n){console.log("Try purchase ".concat(e," by ").concat(n)),this.getYandexGames().then((function(t){return t.getPayments().then((function(t){!function(e){throw new TypeError('"payments" is read-only')}(),null.purchase({id:e}).then((function(e){console.log("Purchased ".concat(e.productID," successfully. ").concat(n)),window.unityInstance.SendMessage(n,"ProcessPurchase")})).catch((function(t){console.log("Purchase ".concat(e," failed! ").concat(n)),window.unityInstance.SendMessage(n,"OnPurchaseFailed",7)}))})).catch((function(t){console.log("Try made purchase ".concat(e," by ").concat(n," but failed becouse of Yandex payments are not activated.")),window.unityInstance.SendMessage(n,"OnPurchaseFailed",4)}))}))}},{key:"initiateReview",value:function(){console.log("Try ask user to review"),this.getYandexGames().then((function(e){return e.feedback.canReview().then((function(n){var t=n.value,o=n.reason;t?e.feedback.requestReview().then((function(e){var n=e.feedbackSent;console.log("Review result:",n)})):console.log("Can't ask review becouse of ",o)}))}))}},{key:"checkPurchase",value:function(e){this.getYandexGames().then((function(n){return n.getPayments().then((function(n){console.log("Getting user purchases"),n.getPurchases().then((function(n){n.forEach((function(n){window.unityInstance.SendMessage(e,"OnPurchaseCheck",n.productID)})),0===n.length&&console.log("No user purchases found")})).catch((function(e){console.log("Getting user purchases failed!")}))})).catch((function(e){console.log("Yandex payments unavailable, getting user purchases failed! ",e)}))}))}},{key:"once",value:function(e,n){return this._emitter.once(e,n),this}},{key:"_addSupportPauseAndResumeEvents",value:function(){var e=this,n="AppVisible",t="AppHidden",o={focus:n,focusin:n,pageshow:n,blur:t,focusout:t,pagehide:t},i="hidden",a=function(a){var r=a?a.type:window.event.type;r in o?e._emitter.emit(o[r]):i in document?e._emitter.emit(document[i]?t:n):console.warn("Unknown eventType:",r)};i in document?document.addEventListener("visibilitychange",a):"mozHidden"in document?(i="mozHidden",document.addEventListener("mozvisibilitychange",a)):"webkitHidden"in document?(i="webkitHidden",document.addEventListener("webkitvisibilitychange",a)):"msHidden"in document?(i="msHidden",document.addEventListener("msvisibilitychange",a)):"onfocusin"in document?(document.onfocusin=a,document.onfocusout=a):(window.onpageshow=a,window.onpagehide=a,window.onfocus=a,window.onblur=a)}},{key:"recreateUnityInstance",value:function(){var e=this;if(null==this._unityConfig)return Promise.reject(new Error("Can't recreate instance. Because instance didn't create before this"));var n=this._unityConfig,t=n.canvas,o=n.config,i=n.onProgress,a=n.onSuccess,r=n.onError,c=n.onRecreate;return null!=this._unityInstance?this._unityInstance.Quit().then((function(){return c instanceof Function&&c(),e._createInstance(t,o,i,a,r)})):this._createInstance(t,o,i,a,r)}},{key:"createUnityInstance",value:function(e,n,t,o,i,a){return this._unityConfig={canvas:e,config:n,onProgress:t,onSuccess:o,onError:i,onRecreate:a},this._createInstance(e,n,t,o,i)}},{key:"_createInstance",value:function(e,n,t,o,i){var a=this;return this._unityInstance=null,window.createUnityInstance(e,n,t).then((function(e){a._unityInstance=e,o instanceof Function&&o(e)})).catch((function(e){i instanceof Function&&i(e)}))}}],o&&f(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function p(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==g(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!==g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===g(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}window.unityapp=new h,document.addEventListener("DOMContentLoaded",(function(){var e,n,t;e=document.getElementById("unity-canvas"),n=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0,document.body.clientWidth||0),t=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0,document.body.clientHeight||0),e.style.cursor="default",e.style.width="100vw",e.style.height="100vh",e.width=n,e.height=t;try{window.unityapp.getYandexGames().then((function(){window.unityapp.storage?window.initUnity():window.unityapp.once("AppStorageLoaded",(function(){window.initUnity()}))}))}catch(e){console.error(e)}})),window.getVersion=function(){return window.ISDKVersion||"1.5"},window.checkAudioPlay=function(){return!1},window.isAudioPlaybackAvailable=function(){return window.checkAudioPlay()},function(){window.AudioContext=window.AudioContext||window.webkitAudioContext;var e=!1,n=function n(){e||(e=!0,document.body.removeEventListener("touchmove",n),document.body.removeEventListener("touchend",n),document.body.removeEventListener("mouseup",n))};document.addEventListener("DOMContentLoaded",(function(){document.body.addEventListener("touchmove",n,!1),document.body.addEventListener("touchend",n,!1),document.body.addEventListener("mouseup",n,!1)}),{once:!0}),window.checkAudioPlay=function(){return e}}();var b={ru:"К сожалению, ваше устройство не поддерживается.",en:"Sorry, your device is not supported."};window.unsupportedDevice=function(){try{var e=document.getElementById("unity-canvas");e&&(e.style.visibility="hidden");var n=document.getElementById("unity-progress-bar");n&&(n.style.visibility="hidden");var t=document.getElementById("unity-content");t&&(t.classList.remove("fade-out"),t.style.removeProperty("display"))}catch(e){}alert(b[yasdkLanguage]||b.en)},window.onerror=function(e,n,t,o,i){if(e.includes("memory")){if(alert(b[yasdkLanguage]||b.en),window&&window.unityInstance)try{var a=window.unityInstance;window.unityInstance=void 0,a.Quit()}catch(e){}}else console.error(i);return!0},window.initUnity=function(){var e=window.unityapp.initUnityConfig,n=e.companyName,t=e.productName,o=e.productVersion,i=e.buildUrl,a=void 0===i?"Build":i,r=e.filenameLoader,c=void 0===r?"":r,s=e.filenameData,u=void 0===s?"":s,d=e.filenameFramework,l=void 0===d?"":d,w=e.filenameCode,f=void 0===w?"":w,y=e.filenameMemory,h=void 0===y?"":y,g=e.filenameSymbols,b=void 0===g?"":g,S=e.configPreset,k=void 0===S?"default":S,P=e.raw,I=void 0===P?{}:P,_=document.querySelector("#unity-canvas"),O=document.querySelector("#unity-progress-bar-fill"),x=document.querySelector("#unity-warning"),A="".concat(a,"/").concat(c),M=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){p(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({dataUrl:"".concat(a,"/").concat(u),frameworkUrl:"".concat(a,"/").concat(l),codeUrl:"".concat(a,"/").concat(f),streamingAssetsUrl:"StreamingAssets",companyName:n,productName:t,productVersion:o,showBanner:function(e,n){var t=function(){x.style.display=x.children.length?"block":"none"},o=document.createElement("div");o.innerHTML=e,x.appendChild(o),"error"===n?o.style="background: red; padding: 10px;":("warning"===n&&(o.style="background: yellow; padding: 10px;"),setTimeout((function(){x.removeChild(o),t()}),5e3)),t()}},I);switch(Object.entries({memoryUrl:h,symbolsUrl:b}).forEach((function(e){var n,t,o=(t=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,i,a,r,c=[],s=!0,u=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=a.call(t)).done)&&(c.push(o.value),c.length!==n);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=t.return&&(r=t.return(),Object(r)!==r))return}finally{if(u)throw i}}return c}}(n,t)||function(e,n){if(e){if("string"==typeof e)return v(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],r=o[1];null!=r&&""!==r&&(M[i]="".concat(a,"/").concat(r))})),k){case"1x1":case"1x1-2":case"1x2":case"1x2-2":default:M.matchWebGLToCanvasSize=!0;case"1x1-1":case"1x1-3":case"1x2-1":case"1x2-3":}switch(k){case"1x1":case"1x1-1":case"1x1-2":case"1x1-3":M.devicePixelRatio=1;break;case"1x2":case"1x2-1":case"1x2-2":case"1x2-3":M.devicePixelRatio=.5;break;default:window.unityapp.isMobile&&(M.devicePixelRatio=window.devicePixelRatio||1,/webOS|iPhone|iPad|iPod/i.test(navigator.userAgent)&&(M.webglContextAttributes={preserveDrawingBuffer:!0}))}var C=0,E=null,B=0,D=function(){if(B>=1)return O.style.width="100%",void(E&&clearInterval(E));var e=Math.min(C,.3),n=.7*B,t=Math.min(1,e+n);O.style.width="calc(2.6rem + (100% - 2.6rem) * ".concat(t.toFixed(2),")")};E=setInterval((function(){C+=.002,D(),E&&C>=.3&&clearInterval(E)}),100);var Y=document.createElement("script");Y.src=A,Y.onload=function(){window.unityapp.createUnityInstance(_,M,(function(e){B=e,D()}),(function(e){window.unityInstance=e;var n=document.getElementById("unity-content");n&&n.classList.toggle("fade-out"),setTimeout((function(){n.style.display="none"}),500)}),(function(e){setTimeout((function(){window.unsupportedDevice(),window.history.back()}),5e3)}),(function(){var e=document.getElementById("unity-content");e.style.display="",e&&e.classList.toggle("fade-out")}))},document.body.appendChild(Y)},window.unityapp.getYandexGames().then((function(e){console.log("Yandex games SDK initialized, is mobile = ".concat(window.unityapp.isMobile))})).catch((function(e){console.log("Yandex games SDK init error: ".concat(e))})),window.wasAdvShown=!1,window.isShowingAd=!1,window.showFullscreenAdv=function(){window.unityapp.getYandexGames().then((function(e){e.adv.showFullscreenAdv({callbacks:{onOpen:function(){window.wasAdvShown=!0,window.isShowingAd=!0,window.unityInstance.SendMessage("InventioAdsManager","ProcessInterstitialOpen"),console.log("Fullscreen ad open.")},onClose:function(e){window.wasAdvShown=e,window.isShowingAd=!1,window.unityInstance.SendMessage("InventioAdsManager","ProcessInterstitialClose",window.wasAdvShown?1:0),document.getElementById("unity-canvas").focus(),console.log("Fullscreen ad closed, was shown: "+window.wasAdvShown),document.getElementById("unity-canvas").focus()},onError:function(e){window.wasAdvShown=!1,window.isShowingAd=!1,window.unityInstance.SendMessage("InventioAdsManager","ProcessInterstitialError",e),console.log("Fullscreen ad error, was shown: ".concat(e)),document.getElementById("unity-canvas").focus()},onOffline:function(){window.wasAdvShown=!1,window.isShowingAd=!1,window.unityInstance.SendMessage("InventioAdsManager","ProcessInterstitialOffline"),document.getElementById("unity-canvas").focus(),console.log("Fullscreen ad offline")}}})}))},window.isShowingFullscreenAdv=function(){return window.isShowingAd},window.showRewardedAds=function(){window.unityapp.getYandexGames().then((function(e){e.adv.showRewardedVideo({callbacks:{onOpen:function(){console.log("Rewarded ad open."),window.unityInstance.SendMessage("InventioAdsManager","ProcessRewardedOpen")},onRewarded:function(){console.log("Rewarded!"),window.unityInstance.SendMessage("InventioAdsManager","ProcessRewardedReceived")},onClose:function(){console.log("Video ad closed."),window.unityInstance.SendMessage("InventioAdsManager","ProcessRewardedClose"),document.getElementById("unity-canvas").focus()},onError:function(e){console.log("Error while open video ad:",e),window.unityInstance.SendMessage("InventioAdsManager","ProcessRewardedError",e.message),document.getElementById("unity-canvas").focus()}}})}))},window.initiatePurchase=function(e,n){window.unityapp.getYandexGames().then((function(t){console.log("Try purchase ".concat(e," by ").concat(n)),t.getPayments().then((function(t){console.log("Getting user purchases"),t.getPurchases().then((function(o){var i=!1;if(o.forEach((function(n){e===n.productID&&(i=!0)})),i)console.log("Purchase ".concat(e," failed! Was already purchased")),window.unityInstance.SendMessage(n,"OnPurchaseFailed",0);else{var a=new Date;t.purchase({id:e,developerPayload:a.toISOString()}).then((function(e){console.log("Purchased ".concat(e.productID," successfully by ").concat(n)),window.unityInstance.SendMessage(n,"ProcessPurchase",JSON.stringify(e)),document.getElementById("unity-canvas").focus()})).catch((function(){console.log("Purchase ".concat(e," failed! ").concat(n)),window.unityInstance.SendMessage(n,"OnPurchaseFailed",7),document.getElementById("unity-canvas").focus()}))}document.getElementById("unity-canvas").focus()}))})).catch((function(){console.log("Try made purchase ".concat(e," by ").concat(n," but failed becouse of Yandex payments are not activated.")),window.unityInstance.SendMessage(n,"OnPurchaseFailed",4),document.getElementById("unity-canvas").focus()}))}))},window.consumePurchase=function(e){console.log("Consume purchase ".concat(e)),window.unityapp.getYandexGames().then((function(n){n.getPayments().then((function(n){n.consumePurchase(e)}))}))},window.consumePurchasesById=function(e){console.log("Consume purchases ".concat(e)),window.unityapp.getYandexGames().then((function(n){n.getPayments().then((function(n){n.getPurchases().then((function(t){t.forEach((function(t){t.productID===e&&n.consumePurchase(t.purchaseToken)}))}))}))}))},window.checkPurchase=function(e){window.isPurchasesUpdated=!1,window.unityapp.getYandexGames().then((function(n){n.getPlayer().then((function(t){"lite"===t.getMode()?(console.log("Player is not autorized, getting purchase is useless"),window.unityInstance.SendMessage(e,"OnPurchaseCheckFailed",0),window.isPurchasesUpdated=!1):(console.log("Player is autorized"),n.getPayments().then((function(n){console.log("Getting user purchases"),n.getPurchases().then((function(n){0===n.length?console.log("No user purchases found"):n.forEach((function(n){window.unityInstance.SendMessage(e,"OnPurchaseCheck",JSON.stringify(n))})),window.isPurchasesUpdated=!0})).catch((function(n){console.log("Getting user purchases failed! - ".concat(n)),window.unityInstance.SendMessage(e,"OnPurchaseCheckFailed",4),window.isPurchasesUpdated=!1}))})).catch((function(n){console.log("Yandex payments unavailable, getting user purchases failed! ".concat(n)),window.unityInstance.SendMessage(e,"OnPurchaseCheckFailed",1),window.isPurchasesUpdated=!1})))})).catch((function(n){console.log("Can't get player from yandex sdk"),window.isPurchasesUpdated=!1,window.unityInstance.SendMessage(e,"OnPurchaseCheckFailed",0)}))})).catch((function(n){console.log("Yandex games SDK init error: ".concat(n)),window.isPurchasesUpdated=!1,window.unityInstance.SendMessage(e,"OnPurchaseCheckFailed",2)}))},window.purchasesUpdated=function(){return window.isPurchasesUpdated},window.initiateReview=function(){window.unityapp.getYandexGames().then((function(e){e.feedback.canReview().then((function(n){var t=n.value,o=n.reason;t?e.feedback.requestReview().then((function(e){console.log("Review result: ".concat(e.feedbackSent)),window.unityInstance.SendMessage("InventioReviewManager","OnRequestReview",e.feedbackSent?1:0),document.getElementById("unity-canvas").focus()})):(console.log("Wasn't review because of ".concat(o)),window.unityInstance.SendMessage("InventioReviewManager","OnReviewDenied",o),window.unityInstance.SendMessage("InventioReviewManager","OnRequestReview",0)),document.getElementById("unity-canvas").focus()}))}))},window.preCheckCanReview=function(){console.log("Try ask user to review"),window.unityapp.getYandexGames().then((function(e){e.feedback.canReview().then((function(e){var n=e.value,t=e.reason;n?(console.log("preCheckCanReview() ".concat(n)),window.unityInstance.SendMessage("InventioReviewManager","OnCanReview")):(console.log("Can't ask review becouse of ".concat(t)),window.unityInstance.SendMessage("InventioReviewManager","OnReviewDenied",t))}))})).catch((function(e){console.log("Yandex SDK unavailable! ".concat(e))}))},window.checkCanReview=function(){return void 0!==window.canReview?(console.log("Can review: ",window.canReview),window.canReview):(console.log("Don't known, if user can review"),!1)},window.yasdkLanguage="ru",window.unityapp.getYandexGames().then((function(e){window.yasdkLanguage=e.environment.i18n.lang})).catch((function(e){console.log("Yandex SDK unavailable! ".concat(e))})),window.getLanguage=function(){return console.log("Yandex language = ".concat(window.yasdkLanguage)),window.yasdkLanguage},window.yasdkTLD="ru",window.unityapp.getYandexGames().then((function(e){window.yasdkTLD=e.environment.i18n.tld})).catch((function(e){console.log("Yandex SDK unavailable! ".concat(e))})),window.getTLD=function(){return console.log("Yandex TLD = ".concat(window.yasdkTLD)),window.yasdkTLD},window.internetReachability=function(){return window.unityapp.hasInternetConnection()},window.stickyAdvIsShowing=!1,window._waitYandexBanner=!1,window.showBanner=function(){window._waitYandexBanner?console.log("showBanner","Waiting banner"):(console.log("showBanner","Try to show sticky banner"),window.unityapp.getYandexGames().then((function(e){return e.adv.getBannerAdvStatus().then((function(n){var t=n.stickyAdvIsShowing,o=n.reason;if(t)window.stickyAdvIsShowing=!0,console.log("showBanner","Sticky banner is already showing");else{if(!o)return e.adv.showBannerAdv().then((function(e){e.stickyAdvIsShowing?(console.log("showBanner","Showing sticky banner"),window.stickyAdvIsShowing=!0):e.reason?(console.log(e.reason),window.stickyAdvIsShowing=!1,window._waitYandexBanner=!1,setTimeout(showBanner,1e4)):(console.log("showBanner","Can't show sticky banner with unknown reason"),window.stickyAdvIsShowing=!1,window._waitYandexBanner=!1,setTimeout(showBanner,1e4))}));console.log(o),window.stickyAdvIsShowing=!1,window._waitYandexBanner=!1,setTimeout(showBanner,1e4)}}))})).catch((function(e){window._waitYandexBanner=!1,console.error("showBanner",e),setTimeout(showBanner,3e3)})),window._waitYandexBanner=!0)},window.hideBanner=function(){console.log("Try to hide sticky banner"),window._waitYandexBanner=!0,window.unityapp.getYandexGames().then((function(e){return e.adv.getBannerAdvStatus().then((function(n){n.stickyAdvIsShowing&&(e.adv.hideBannerAdv(),console.log("hideBanner","Hiding sticky banner"),window.stickyAdvIsShowing=!1)}))})).catch((function(e){console.error("hideBanner",e)}))},window.isShowingBanner=function(){return window.stickyAdvIsShowing},window.getCatalog=function(e){window.unityapp.getYandexGames().then((function(n){n.getPlayer().then((function(t){"lite"===t.getMode()?(console.log("Player is not autorized, getting purchase is useless"),window.unityInstance.SendMessage(e,"OnGetCatalog","")):(console.log("Player is autorized"),n.getPayments().then((function(n){console.log("Getting products catalog"),n.getCatalog().then((function(n){0===n.length?(console.log("No products found"),window.unityInstance.SendMessage(e,"OnGetCatalog","")):window.unityInstance.SendMessage(e,"OnGetCatalog",'{"products":'.concat(JSON.stringify(n),"}"))})).catch((function(n){console.log("Getting products catalog failed! - ".concat(n)),window.unityInstance.SendMessage(e,"OnGetCatalog","")}))})).catch((function(n){console.log("Yandex payments unavailable, getting products catalog failed! ".concat(n)),window.unityInstance.SendMessage(e,"OnGetCatalog","")})))})).catch((function(){console.log("Can't get player from yandex sdk"),window.unityInstance.SendMessage(e,"OnGetCatalog","")}))})).catch((function(n){console.log("Yandex games SDK init error: ".concat(n)),window.unityInstance.SendMessage(e,"OnGetCatalog","")}))}})();
